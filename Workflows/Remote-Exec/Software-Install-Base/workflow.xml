<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns2:workflow xmlns:ns2="http://vmware.com/vco/workflow" root-name="item12" object-name="workflow:name=generic" id="4a41e93c-36b4-46db-ac3c-6a73514135c4" editor-version="2.0" version="1.0.0" api-version="6.0.0" allowed-operations="evf" restartMode="1" resumeFromFailedMode="0">
    <display-name>Software-Install-Base</display-name>
    <position y="50.58823529411765" x="27.058823529411768"/>
    <input>
        <param name="machinename" type="string">
            <description>vCenter Machine Name</description>
        </param>
        <param name="vcfqdn" type="string">
            <description>vCenter FQDN</description>
        </param>
        <param name="script" type="string">
            <description>Script to run in guest</description>
        </param>
        <param name="reboot" type="boolean">
            <description>Is reboot required</description>
        </param>
        <param name="vc_cred_name" type="string">
            <description>LCM VC Credential Name</description>
        </param>
        <param name="template_locker_creds" type="string">
            <description>Template local admin credentials in locker</description>
        </param>
    </input>
    <output>
        <param name="customScriptOutput" type="DynamicTypes:CustomScript.Script"/>
    </output>
    <attrib name="lcm_user" type="string">
        <value encoded="n">admin@local</value>
    </attrib>
    <attrib name="lcm_pass" type="SecureString">
        <value encoded="n">8BT56X4DU77V61N72M65Z31V21O537FA65X642EEFAMF6DD4CEW3858A4AO7192958UB24267DMB83A426S1F495A7WEE1C33AO5C502CCU5EF699CH42BA16CN1925A5AYE516197QB1EB5B7S2C4ECBCU658F6B6XE8B3387L4E2934FYAC718F7O4464582T7F64B04T37B2796WAAA1D01H</value>
    </attrib>
    <attrib name="vc_username" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="vc_password" type="SecureString">
        <value encoded="n"></value>
    </attrib>
    <attrib name="template_username" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="template_password" type="SecureString">
        <value encoded="n"></value>
    </attrib>
    <attrib name="lcmfqdn" type="string">
        <value encoded="n">vrlcm01.vcc.vmw</value>
    </attrib>
    <attrib name="vRADeploymentId" type="string">
        <value encoded="n"></value>
    </attrib>
    <attrib name="sleepTime" type="number">
        <value encoded="n">800.0</value>
    </attrib>
    <workflow-item name="item1" out-name="item4" type="task" script-module="pscommand/run_script" comparator="0">
        <display-name>run-script</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("pscommand").run_script(machinename,vcfqdn,vcuser,vcpassword,script,remoteuser,remotepassword);
</script>
        <in-binding>
            <bind name="machinename" type="string" export-name="machinename"/>
            <bind name="vcfqdn" type="string" export-name="vcfqdn"/>
            <bind name="vcuser" type="string" export-name="vc_username"/>
            <bind name="vcpassword" type="SecureString" export-name="vc_password"/>
            <bind name="script" type="string" export-name="script"/>
            <bind name="remoteuser" type="string" export-name="template_username"/>
            <bind name="remotepassword" type="SecureString" export-name="template_password"/>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="string"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="60.53132272436747" x="1051.7605436813806"/>
    </workflow-item>
    <workflow-item name="item3" type="end" end-mode="0" comparator="0">
        <in-binding/>
        <out-binding/>
        <position y="139.94308743024982" x="1203.5252495637337"/>
    </workflow-item>
    <workflow-item name="item4" out-name="item5" alt-out-name="item3" type="condition" comparator="0">
        <display-name>Is Reboot Needed</display-name>
        <script encoded="false">// Generated by the system, cannot be edited
return (reboot === true);</script>
        <in-binding>
            <bind name="reboot" type="boolean" export-name="reboot"/>
        </in-binding>
        <out-binding/>
        <description>Is Reboot Required</description>
        <condition name="reboot" type="boolean" comparator="0" label="null"></condition>
        <position y="50.53132272436747" x="1145.8781907402044"/>
    </workflow-item>
    <workflow-item name="item5" out-name="item6" type="task" script-module="pscommand/RebootVM" comparator="0">
        <display-name>Reboot VM</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("pscommand").RebootVM(machinename,vcfqdn,vcuser,vcpassword);
</script>
        <in-binding>
            <bind name="machinename" type="string" export-name="machinename"/>
            <bind name="vcfqdn" type="string" export-name="vcfqdn"/>
            <bind name="vcuser" type="string" export-name="vc_username"/>
            <bind name="vcpassword" type="SecureString" export-name="vc_password"/>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="string"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="60.53132272436747" x="1239.9958377990279"/>
    </workflow-item>
    <workflow-item name="item6" out-name="item3" type="task" script-module="pscommand/WaitForVMtools" comparator="0">
        <display-name>Wait for VMTools</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("pscommand").WaitForVMtools(vcfqdn,vcuser,vcpassword,machinename);
</script>
        <in-binding>
            <bind name="vcfqdn" type="string" export-name="vcfqdn"/>
            <bind name="vcuser" type="string" export-name="vc_username"/>
            <bind name="vcpassword" type="SecureString" export-name="vc_password"/>
            <bind name="machinename" type="string" export-name="machinename"/>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="string"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="60.53132272436747" x="1381.172308387263"/>
    </workflow-item>
    <workflow-item name="item7" out-name="item8" type="task" script-module="pscommand/get_user_locker" comparator="0">
        <display-name>Get VC Username</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("pscommand").get_user_locker(lcm_fqdn,lcm_user,lcm_pass,creds_name);
</script>
        <in-binding>
            <bind name="lcm_fqdn" type="string" export-name="lcmfqdn"/>
            <bind name="lcm_user" type="string" export-name="lcm_user"/>
            <bind name="lcm_pass" type="SecureString" export-name="lcm_pass"/>
            <bind name="creds_name" type="string" export-name="vc_cred_name"/>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="string" export-name="vc_username"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="60.58823529411765" x="340.0"/>
    </workflow-item>
    <workflow-item name="item8" out-name="item14" type="task" script-module="pscommand/get_password_locker" comparator="0">
        <display-name>Get VC Password</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("pscommand").get_password_locker(lcm_fqdn,lcm_user,lcm_pass,creds_name);
</script>
        <in-binding>
            <bind name="lcm_fqdn" type="string" export-name="lcmfqdn"/>
            <bind name="lcm_user" type="string" export-name="lcm_user"/>
            <bind name="lcm_pass" type="SecureString" export-name="lcm_pass"/>
            <bind name="creds_name" type="string" export-name="vc_cred_name"/>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="SecureString" export-name="vc_password"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="60.58823529411765" x="457.6470588235294"/>
    </workflow-item>
    <workflow-item name="item9" out-name="item10" type="task" script-module="pscommand/get_user_locker" comparator="0">
        <display-name>Get Local Admin Username</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("pscommand").get_user_locker(lcm_fqdn,lcm_user,lcm_pass,creds_name);
</script>
        <in-binding>
            <bind name="lcm_fqdn" type="string" export-name="lcmfqdn"/>
            <bind name="lcm_user" type="string" export-name="lcm_user"/>
            <bind name="lcm_pass" type="SecureString" export-name="lcm_pass"/>
            <bind name="creds_name" type="string" export-name="template_locker_creds"/>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="string" export-name="template_username"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="59.94308743024982" x="777.642896622557"/>
    </workflow-item>
    <workflow-item name="item10" out-name="item1" type="task" script-module="pscommand/get_password_locker" comparator="0">
        <display-name>Get Local Template Password</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("pscommand").get_password_locker(lcm_fqdn,lcm_user,lcm_pass,creds_name);
</script>
        <in-binding>
            <bind name="lcm_fqdn" type="string" export-name="lcmfqdn"/>
            <bind name="lcm_user" type="string" export-name="lcm_user"/>
            <bind name="lcm_pass" type="SecureString" export-name="lcm_pass"/>
            <bind name="creds_name" type="string" export-name="template_locker_creds"/>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="SecureString" export-name="template_password"/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="59.94308743024982" x="917.642896622557"/>
    </workflow-item>
    <workflow-item name="item11" out-name="item7" type="link" linked-workflow-id="480a86c2-1370-458f-935a-c42c37160afc" comparator="0">
        <display-name>Create Custom Script DynType</display-name>
        <in-binding>
            <bind name="script" type="string" export-name="script"/>
            <bind name="vcfqdn" type="string" export-name="vcfqdn"/>
            <bind name="reboot" type="boolean" export-name="reboot"/>
            <bind name="machinename" type="string" export-name="machinename"/>
            <bind name="vc_cred_name" type="string" export-name="vc_cred_name"/>
            <bind name="template_locker_creds" type="string" export-name="template_locker_creds"/>
        </in-binding>
        <out-binding>
            <bind name="customScriptOutput" type="DynamicTypes:CustomScript.Script" export-name="customScriptOutput"/>
        </out-binding>
        <description> </description>
        <position y="60.58823529411765" x="198.8235294117647"/>
    </workflow-item>
    <workflow-item name="item12" out-name="item11" type="task" comparator="0">
        <display-name>Get Deployment Id</display-name>
        <script encoded="false">var vRADeploymentId = System.getContext().getParameter("__metadata_deploymentId");</script>
        <in-binding/>
        <out-binding>
            <bind name="vRADeploymentId" type="string" export-name="vRADeploymentId"/>
        </out-binding>
        <description>Simple task with custom script capability.</description>
        <position y="60.58823529411765" x="81.1764705882353"/>
    </workflow-item>
    <workflow-item name="item13" out-name="item9" type="task" script-module="pscommand/WaitForVMtools" comparator="0">
        <display-name>Wait for VMtools</display-name>
        <script encoded="false">//Auto generated script, cannot be modified !
actionResult = System.getModule("pscommand").WaitForVMtools(vcfqdn,vcuser,vcpassword,machinename);
</script>
        <in-binding>
            <bind name="vcfqdn" type="string" export-name="vcfqdn"/>
            <bind name="vcuser" type="string" export-name="vc_username"/>
            <bind name="vcpassword" type="SecureString" export-name="vc_password"/>
            <bind name="machinename" type="string" export-name="machinename"/>
        </in-binding>
        <out-binding>
            <bind name="actionResult" type="string" export-name=""/>
        </out-binding>
        <description>Add a note to the workflow schema.</description>
        <position y="59.94308743024982" x="657.642896622557"/>
    </workflow-item>
    <workflow-item name="item14" out-name="item13" type="link" linked-workflow-id="7ced6eda-298e-4d62-9811-7cb9c61f382b" comparator="0">
        <display-name>Improved Sleep</display-name>
        <in-binding>
            <bind name="delay" type="number" export-name="sleepTime">
                <description>Time to wait (seconds)</description>
            </bind>
        </in-binding>
        <out-binding/>
        <description> </description>
        <position y="59.97154371512491" x="548.8214483112786"/>
    </workflow-item>
    <presentation>
        <p-param name="machinename">
            <desc>vCenter Machine Name</desc>
        </p-param>
        <p-param name="vcfqdn">
            <desc>vCenter FQDN</desc>
        </p-param>
        <p-param name="script">
            <desc>Script to run in guest</desc>
        </p-param>
        <p-param name="reboot">
            <desc>Is reboot required</desc>
        </p-param>
        <p-param name="vc_cred_name">
            <desc>LCM VC Credential Name</desc>
        </p-param>
        <p-param name="template_locker_creds">
            <desc>Template local admin credentials in locker</desc>
        </p-param>
    </presentation>
</ns2:workflow>
